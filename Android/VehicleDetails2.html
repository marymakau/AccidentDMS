<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Accident DMS</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
      
  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">  
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">  
  <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css"> 
  <link rel="stylesheet" href="css/font-awesome.min.css">  
  <link rel="stylesheet" href="plugins/iCheck/all.css">
  <link rel="stylesheet" href="jqueryui/jquery-ui.min.css"/>
  <script src="js/jquery.js"></script>
  <script>
    var login = window.localStorage.getItem('login');         
    if(login !== '1'){
      window.location = 'login.html';
    }
  </script>
</head>
<body class="hold-transition skin-blue sidebar-mini">
<!-- Site wrapper -->
<div class="wrapper">

  <header class="main-header">
    <!-- Logo -->
  
    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

     </nav>
  </header>

  <!-- =============================================== -->

  <!-- Left side column. contains the sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
     
      
      <ul class="sidebar-menu">
         <li>
                        <a href="NewAccident.html"><i class="glyphicon glyphicon-home"></i> Home</a>
                    </li>
                    <li class="active">
                        <a href="NewAccident.html"><i class="glyphicon glyphicon-file"></i> File New Accident</a>
                    </li>
                    <li>
                        <a href="NewAccident.html"><i class="glyphicon glyphicon-edit"></i> Edit Stored Accident</a>
                    </li>
                    
                    <li>
                        <a href="NewAccident.html"><i class="glyphicon glyphicon-open-file"></i> View Stored Accident</a>
                    </li>
                    <li>
                        <a href="NewAccident.html"><i class="glyphicon glyphicon-user"></i> Profile</a>
                    </li>
                    <li>
                    <a href="login.html"onclick="localStorage.removeItem('UserName');"><i class="glyphicon glyphicon-off"></i> Logout</a>
                    </li>
      </ul>
    </section>
    <!-- /.sidebar -->
  </aside>

  <!-- =============================================== -->

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        <small><strong>Vehicles No.1 Other Details</strong></small>
      </h1>
       <ol class="breadcrumb">
          <li>
              <i class="glyphicon glyphicon-home"></i>  <a href="index.html">Home</a>
          </li>
          <li class="active">
              <i class="glyphicon glyphicon-automobile"></i> Vehicle Details
          </li>
       </ol>
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="box">        
        <div class="box-body">
          <form name="VEHICLE_DETAILS_FORM_2"
            id="VEHICLE_DETAILS_FORM_2"
            method="post">
            <div class="text-center" id="searchResponse"></div>
                <div class="form-group">
                   <label>Vehicle registered to</label>
                   <input class="form-control" 
                      type='text' 
                      name="ownerName"
                      id="ownerName"
                      value='' 
                      placeholder="Vehicle Owner"readonly>
                </div> 
            
                <div class="form-group">
                   <label>Vehicle Make</label>
                   <input class="form-control"
                      type='text' 
                      name="vehicleMake"
                      id="vehicleMake"
                      value=''
                      placeholder="Vehicle Make"readonly>
                </div>
                <div class="form-group">
                  <label>Vehicle Model</label>
                  <input class="form-control" 
                    type='text'
                    name='vehicleModel'
                    id="vehicleModel"
                    value='' 
                    placeholder="Vehicle Model"readonly>
                </div>
                <div class="form-group">
                 <label>Primary Insuarance Company</label>
                 <input class="form-control"
                    type='text'
                    name="insuarer"
                    id="insuarer"
                    placeholder="Insuarance Company eg DirectLine">
                </div>
            
                <div class="form-group">
                  <label>Insuarance Policy Number</label>
                  <input class="form-control" 
                    type='text' 
                    name='policyNumber' 
                    id="policyNumber"
                    placeholder="Policy Number">
                </div>
            
                <div class="form-group">
                  <label> Insuarance cover expired? </label>  <br>             
                  <label>
                    <input type="radio" value="Yes" class="flat-red" name="coverExpired">
                    Yes
                  </label>
                  <br>
                  <label>
                    <input type="radio" value="No" class="flat-red" name="coverExpired">
                    No
                  </label>
                </div>
            
                <div class="form-group">
                  <label>Other Insuarance Cover</label>
                  <textarea class="form-control"
                      rows="3"
                      name="other"
                      id="other"
                      placeholder="Company,Policy Number,Expiry Status(Yes/No)"
                      style="resize: none;"></textarea>
                </div>            
                <br>
                <b class="active"> 
                  <a href="PoliceRemarks.html"
                    id="nextPoliceRemarksForm"
                    style='float:right'>
                    <i class="glyphicon glyphicon-forward"></i>
                  </a>
                </b>
                <b class="active"> 
                  <a href="VehicleDriverDetails.html">
                    <i class="glyphicon glyphicon-backward"></i>
                  </a>
                </b> 
            </form>
        </div> 
    </div>

    </section>
        <script src="js/jquery.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="jqueryui/jquery-ui.min.js"></script>
       
   </div>
  <!-- /.content-wrapper -->

  <footer class="main-footer">
    <div class="pull-right hidden-xs">
    </div>
    <strong>Copyright &copy; 2016 <a href="index.html">Kenya Traffic Police</a>.</strong> 
    All rights reserved.
  </footer>

   <div class="control-sidebar-bg"></div>
</div>
    <script src="bootstrap/js/bootstrap.min.js"></script>  
    <script src="plugins/slimScroll/jquery.slimscroll.min.js"></script>    
    <script src="plugins/fastclick/fastclick.js"></script>    
    <script src="dist/js/app.min.js"></script>    
    <script src="dist/js/demo.js"></script>    
    <script src="bootstrap/js/bootstrap.min.js"></script>    
    <script src="plugins/iCheck/icheck.min.js"></script>

    <script>
      $(function () {
        $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
          checkboxClass: 'icheckbox_flat-blue',
          radioClass: 'iradio_flat-blue'
        });});
    </script>

    <!--Auto populate Extra Vehicle Details Form-->
    <script>
       var srvRqst = $.ajax({
          url:'PoliceServer/route.php',
          data:{
              REQUEST_TYPE:'GET_ACCIDENT_FORM_DATA',
              UserName: window.localStorage.getItem('UserName'),

              formType: 'VEHICLE_DETAILS_2_FORM',
              accidentID: window.localStorage.getItem('AccidentID'),
            },
          type:'post',
          datatype:'json'
        });    srvRqst.done(function(responseMsg){
           var responseObj = $.parseJSON(responseMsg);
           if(responseObj['STATUS'] === '1'){
             var formData = responseObj['DATA']['data'];
             setTimeout(function(){
                $('#ownerName').val(formData['data']['ownerName']);       
                $('#vehicleMake').val(formData['data']['vehicleMake']);
                $('#vehicleModel').val(formData['data']['vehicleModel']);            
                $('#insuarer').val(formData['data']['insuarer']);
                $('#policyNumber').val(formData['data']['policyNumber']);
                $('#coverExpired').val(formData['data']['coverExpired']);
                $('#other').val(formData['data']['other']);
             }, 0);
              
           } 
         });
    </script>

    <script>
      $(document).on('click', '#nextPoliceRemarksForm', function(e){
        e.preventDefault();
        var ownerName = $('#ownerName').val();
        var vehicleMake = $('#vehicleMake').val();
        var insuarer = $('#insuarer').val();
        var policyNumber = $('#policyNumber').val();
        var vehicleModel = $('#vehicleModel').val();

        var coverExpired = null;
        if($('input[name=coverExpired][value=Yes]').is(':checked')){
          coverExpired = 'Yes';
        }
        else{
          coverExpired = 'No';
        }
        var other = $('#other').val();
        var data = {
          REQUEST_TYPE:'VEHICLE_DETAILS_2_FORM',
          UserName: window.localStorage.getItem('UserName'),
          AccidentID: window.localStorage.getItem('AccidentID'),
          ownerName:ownerName,
          vehicleMake:vehicleMake,
          vehicleModel:vehicleModel,
          insuarer:insuarer,
          policyNumber:policyNumber,
          coverExpired:coverExpired,
          other:other
        };
    
        var srvRqst = $.ajax({
          url:'PoliceServer/route.php',
          data:data,
          type:'post',
          datatype:'json'
        });
   
        srvRqst.done(function(srvResponse){
          var responseMsg = $.parseJSON(srvResponse);  
          if(responseMsg['STATUS'] === '1'){
            window.location = 'PoliceRemarks.html'; 
          }        
        });     
      });
    </script>
<!--
auto populate vehicle owner make and model based on the vehicle registration number-->

    <script >
          var srvRqst = $.ajax({
          url:'PoliceServer/route.php',
          data: {
              REQUEST_TYPE: 'GET_EXTRA_VEHICLE_DETAILS',
              regNumber: window.localStorage.getItem('VehicleRegNumber')
          },
          type:'post',
          datatype:'json'
        });
          srvRqst.done(function(srvResponse){
            var responseObj = $.parseJSON(srvResponse);  
            $('#vehicleMake').val(responseObj['VehicleMake']) ;
            $('#vehicleModel').val(responseObj['VehicleModel']);
            $('#ownerName').val(responseObj['VehicleOwner']);
        });
    </script>
</body>
</html>
